\documentclass{article}

% keep hyperref before icml as in the template
%\usepackage{hyperref}
%\usepackage[hypertexnames=false]{hyperref}

%\usepackage[margin=1in]{geometry}
% Use exactly one of these lines:
%\usepackage{icml2025}            % for review/blind
\usepackage[accepted]{icml2025}   % camera-ready only AFTER acceptance
%\usepackage[preprint]{icml2025}

% --- Allowed, non-layout packages ---
\usepackage[utf8]{inputenc}     % optional; default UTF-8 is fine
\usepackage{graphicx}
\usepackage{subcaption}           % keep only ONE copy; avoid loading 'caption' separately
\captionsetup{compatibility=false} % suppress caption package warning for unknown class
\usepackage{microtype}
\usepackage{booktabs}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{enumitem}
\usepackage{textgreek}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{lmodern}
\usepackage{balance}
% \usepackage{float}              % avoid unless necessary
\usepackage{fancyhdr}
\fancypagestyle{firstpage}{\fancyhf{}}
\thispagestyle{firstpage}


\newcommand{\TestBench}{LLM TestBench}
\newcommand{\CIGate}{CI/Release gate}

\newcommand{\WS}{\mathrm{WILSON}}
\newcommand{\UCCT}{\mathrm{UCCT}}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

% --------- scalable fiber-grid figure (drop-in) ----------
% Controls (edit these only):
\newcommand{\Npos}{6}          % number of positions (columns)
\newcommand{\Nlayers}{5}       % number of layers (rows), indexed 0..Nlayers-1
\newcommand{\DX}{0.9}          % horizontal spacing (cm)
\newcommand{\DY}{0.6}          % vertical spacing (cm)
% loop rectangle corners (i from..to, layer from..to), small 1x1 by default
\newcommand{\LoopIStart}{2}
\newcommand{\LoopIEnd}{3}
\newcommand{\LoopLStart}{1}
\newcommand{\LoopLEnd}{2}
% appearance
\newcommand{\DotSize}{1.3pt}
\newcommand{\AttnLift}{0.35}   % vertical lift of horizontal curves
\usepackage{hyperref}  % make sure this is present

% define AFTER hyperref
%\DeclareRobustCommand{\figref}[1]{Fig.~\ref*{#1}}
\usepackage{refcount}

\newcommand{\figref}[1]{Fig.~\getrefnumber{#1}}

% usage: (\figref{fig:comm-heatmap})


% REMOVE this line â€“ it triggers the ICML margin check
% \usepackage{geometry}
% and never call \geometry{...}

% TikZ/PGF are fine; they do not change margins
\usepackage{tikz}
\usetikzlibrary{arrows.meta,positioning,calc,decorations.pathreplacing,fit}
\usepackage{pgfplots}
\pgfplotsset{compat=1.18}
%\usepackage[pgfplots]
\usepgfplotslibrary{groupplots} % after \usepackage{pgfplots}

\usepackage{tikz-cd}

\icmltitlerunning{Inverse-Free Wilson Loops for Transformers}

\makeatletter
% These names cover most icml20xx styles
\@ifundefined{icml@copyrighthdr}{}{%
  \renewcommand{\icml@copyrighthdr}{}%
}
\@ifundefined{icml@copyrighttext}{}{%
  \renewcommand{\icml@copyrighttext}{}%
}
\@ifundefined{icmlfancyfoot}{}{%
  \renewcommand{\icmlfancyfoot}[1]{}%
}
\icmltitlerunning{Inverse-Free Wilson Loops for Transformers}

\begin{document}
    
\twocolumn[
\icmltitle{Inverse-Free Wilson Loops for Transformers: A Practical Diagnostic for Invariance and Order Sensitivity}

\begin{icmlauthorlist}
\icmlauthor{Edward Y. Chang, Stanford University}{stan}
\icmlauthor{Ethan Y. Chang, UIUC}{uiuc}
\end{icmlauthorlist}

%\icmlaffiliation{stan}{Computer Science, Stanford University}
%\icmlcorrespondingauthor{Edward Y. Chang}{echang@cs.stanford.edu}
\icmlkeywords{Large Language Models, Group Theory, Curvature, Diagnostics}

\vskip 0.3in  % space below the full-width title/author block
]

%\printAffiliationsAndNotice{} % or {\icmlEqualContribution}

\begin{abstract}
Large language models can change answers under harmless edits that matter in practice: RAG outputs flip when passages are reordered, fine-tuning erodes invariances learned at pretraining, debate or chain-of-thought prompts take path-dependent routes, and compiler fusion or reordering perturbs logits near decision boundaries. These failures violate intended invariances, break continuous integration, and force teams to trade safety for speed. The effects are small yet distributed across layers and positions, sensitive to context length and evaluation order, and costly to repair with retraining or formal verification.
We present $\WS$, a minimal post-hoc diagnostic suite that converts simple loop and reordering checks on internal representations into system signals. $\WS$ combines an inverse-free curvature map over positions and layers, computed with JVPs and Hutchinson probes, with activation-level commutators that flag reorder risk. Signals are cheap to compute, model-agnostic for standard Transformers, and exported as thresholds and CSV artifacts for orchestrators. This enables concrete actions: guard RAG against order effects, catch fine-tuning regressions, stabilize debate pathways and long multi-turn contexts, and gate fusions or reorders in deployment. In short, WILSON helps anticipate failures and approve safe optimizations so reliability and throughput can improve together without changing model architecture or training.
\end{abstract}



% ---- Sections come from external files ----
\input{Introduction}        % <-- your Intro file (below)
\input{RelatedWork}
\input{Method}       % defines Eq.~\eqref{eq:invfree-kappa}; add the line 
\input{Diagnostics}  % defines figs: comm-heatmap, comm-drift, fiber-grid, holonomy-
\input{Metrics}      % references figs above and Table~\ref{tab:diag-setup}
\input{Systems}      % defines fig:systems-wiring
\input{Experiments}
\input{Conclusion}

% =========================
% AUTHOR CONTRIBUTIONS
% =========================
\section*{Acknowledgment of AI Assistance}

The author(s) conceived the problem and core methods (discrete bundle over position and layer, inverse-free Wilson-loop curvature $\kappa_{\mathrm{inv}}$, and commutator-based order-sensitivity diagnostics), designed the E1--E7 suite and metrics, set scope and systems integration, curated related work, and wrote and edited the manuscript.

OpenAI's GPT-5 Thinking was used under direction as a writing and tooling aid to help with restructuring, section polish, and small illustrative code snippets (JVP/Hutchinson examples, commutator gates, planner sketch). The model is not an author. All technical decisions and claims were made and approved by the human author(s); no proprietary or sensitive data were provided; any errors remain the responsibility of the human author(s).


\bibliographystyle{plainnat}
\bibliography{WILSON,Physics,EdwardChang}

\clearpage
\section*{Appendices}
\appendix
\input{AppendixTheories}   % proofs
\input{AppendixCodeListings}
\input{AppendixBlackBoxDemo}

\end{document}
