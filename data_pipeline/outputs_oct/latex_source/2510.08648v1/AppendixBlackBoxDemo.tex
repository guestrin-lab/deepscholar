% =========================
% Appendix: Minimal Black-box Demo in ChatGPT
% =========================
% Add "\appendix" before this section in your main tex if not already present.

\balance
\section{Minimal black-box demo in ChatGPT}
\label{app:blackbox-demo}

This appendix shows how to approximate WILSON-style checks in a public chat interface with no access to logits, JVPs, or internals. We use black-box proxies:
\begin{itemize}[leftmargin=1.2em,itemsep=2pt]
\item \textbf{Invariance ratio (IR)}: fraction of paraphrases that yield the same final answer as a majority reference for a fixed base query.
\item \textbf{Pathway discrepancy ratio (PDR)}: fraction of pathway templates (for example, two styles of prompting) that yield different final answers on the same query.
\item \textbf{Ordering drift (OD)}: indicator that swapping two context passages changes the final answer.
\end{itemize}
These proxies cannot replace $\kappa_{\mathrm{inv}}$ or commutators. They demonstrate the operational idea: measure, threshold, and then act.

\subsection{Setup and scoring}
\label{app:setup}
Use a single chat thread. For each run, request a \emph{final answer only} format to reduce variance.
\begin{quote}
\small
\texttt{Reply with the final answer only. If multiple choices are shown, reply with the letter only.}
\end{quote}
For each task, record outputs in a CSV with the columns shown in Listing~\ref{lst:csv-template}. Compute:
\begin{footnotesize}
\[
\mathrm{IR}(q)=\frac{\text{\# paraphrases that match the majority answer}}{\text{total paraphrases}},
\]
\[
\mathrm{PDR}(q)=\frac{\text{\# pathway prompts with different final answers}}{\text{total pathways}},\]
\[
\mathrm{OD}(q)=\mathbb{1}[\text{answer changes under passage swap}].
\]
\end{footnotesize}

\begin{lstlisting}[
  language={}, label={lst:csv-template},
  basicstyle=\ttfamily\footnotesize,
  caption={CSV template for black-box scoring.}
]
task_id,variant,condition,input_id,
final_answer,correct,notes
paraphrase,base,MCQ,v0,A,1,""
paraphrase,paraphrase,MCQ,v1,A,1,""
paraphrase,paraphrase,MCQ,v2,B,0,"changed"
pathway,templateA,MCQ,tA,A,1,"answer only"
pathway,templateB,MCQ,tB,A,1,"think internally, answer only"
ordering,A_then_B,context,q1,Tuesday,1,""
ordering,B_then_A,context,q1,Monday,0,"drift"
\end{lstlisting}

\subsection{Demo 1: Prompt robustness under paraphrase (IR)}
\label{app:demo-paraphrase}
We use a simple multiple-choice item with a known answer. The goal is not to trick the model, but to measure stability under harmless rewordings.

\paragraph{Base item (copy into the chat).}
\begin{quote}\small
Which is larger?  
A) $2^{100}$  
B) $10^{30}$  
C) They are equal  
D) Not enough information  
Reply with the letter only.
\end{quote}

\paragraph{Paraphrase set.} Ask the same question six ways. Paste one at a time, each in a fresh message in the same thread.
\begin{enumerate}[leftmargin=1.2em,itemsep=1pt]
\item Which quantity has the greater magnitude, $2^{100}$ or $10^{30}$? Choose A, B, C, or D.
\item Compare $2^{100}$ and $10^{30}$. Which is bigger? A, B, C, or D.
\item Decide which value exceeds the other: $2^{100}$ vs $10^{30}$. Answer with A, B, C, or D.
\item Select the larger value from the options: A) $2^{100}$, B) $10^{30}$, C) equal, D) insufficient data.
\item Among $2^{100}$ and $10^{30}$, which is numerically greater? Reply A, B, C, or D.
\item Choose the correct option that identifies the larger number: A) $2^{100}$, B) $10^{30}$, C) equal, D) not enough information.
\end{enumerate}

\paragraph{Scoring.} Let the majority answer across the six paraphrases define the reference. Compute $\mathrm{IR}$ as the fraction that match the reference. Record in the CSV. A robust prompt shows $\mathrm{IR}=1$.

\subsection{Demo 2: Pathway stability with template prompts (PDR)}
\label{app:demo-pathway}
Use the same base item as in A.2. Issue two prompts that differ only in pathway style.

\paragraph{Template A.}
\begin{quote}\small
Answer with the final letter only. Do not include steps.
\end{quote}

\paragraph{Template B.}
\begin{quote}\small
Think through the problem internally. Output only the final letter. Do not include steps.
\end{quote}

\paragraph{Scoring.} If the letters differ, count a discrepancy. Compute $\mathrm{PDR}$ over a small set of items. High $\mathrm{PDR}$ suggests fragile reasoning pathways.

\subsection{Demo 3: Simulated passage ordering sensitivity (OD)}
\label{app:demo-ordering}
We simulate RAG ordering with two short synthetic passages.

\paragraph{Passage A.}
\begin{quote}\small
Alpha City Library moved its weekly closure from Monday to Tuesday in July. Notices were posted on June 28.
\end{quote}

\paragraph{Passage B.}
\begin{quote}\small
The library used to close on Mondays to balance weekend staffing. Some older flyers still mention Monday.
\end{quote}

\paragraph{Query.}
\begin{quote}\small
On which weekday is the library currently closed?
\end{quote}

\paragraph{Prompt 1: A then B.}
\begin{quote}\small
Context: [A][B]  
Question: On which weekday is the library currently closed?  
Reply with a single weekday.
\end{quote}

\paragraph{Prompt 2: B then A.}
\begin{quote}\small
Context: [B][A]  
Question: On which weekday is the library currently closed?  
Reply with a single weekday.
\end{quote}

\paragraph{Scoring.} If answers differ, set $\mathrm{OD}=1$ for this item. This approximates position bias in retrieval order.

\subsection{Two-model correlation without internals}
\label{app:twomodel}
Repeat A.2 to A.4 on two models, denoted A and B, using the same paraphrases, templates, and contexts.

\paragraph{Per item measures.} For each base item $q$:
\[
\mathrm{IR}_A(q),\ \mathrm{IR}_B(q),\ \mathrm{PDR}_A(q),\ \mathrm{PDR}_B(q),\ \mathrm{OD}_A(q),\ \mathrm{OD}_B(q).
\]
Define a sensitivity index $\mathrm{SI}(q)=1-\mathrm{IR}(q)$. Define cross-model drift $\mathrm{D}_{A,B}(q)=\mathbb{1}[\text{majority answer of A} \neq \text{majority answer of B}]$.

\paragraph{Analysis.} Compute Pearson $r$ or Spearman $\rho$ between $\mathrm{SI}_A$ and $\mathrm{D}_{A,B}$ across items. Repeat for $\mathrm{SI}_B$. If $\mathrm{SI}$ correlates with cross-model disagreement, then paraphrase sensitivity predicts when models diverge. Report the mean of $\mathrm{OD}$ as an ordering risk rate.

\subsection{Relation to WILSON signals}
\label{app:relation}
The black-box proxies approximate WILSONâ€™s intent.
\begin{itemize}[leftmargin=1.2em,itemsep=1pt]
\item High $\mathrm{SI}$ suggests regions where WILSON would report high $\kappa_{\mathrm{inv}}$ for the relevant positions and layers.
\item Nonzero $\mathrm{OD}$ suggests a nonzero commutator between the two ordering paths in the attention or residual pipeline.
\item A two-model study that correlates $\mathrm{SI}$ with $\mathrm{D}_{A,B}$ mirrors a cross-model analysis of curvature clusters under a gauge-stable alignment, which we reserve for future work.
\end{itemize}

\subsection{Copy-ready prompt bundle}
\label{app:prompt-bundle}
Paste each block as a separate message.

\paragraph{Header.}
\begin{quote}\small
Reply with the final answer only. If multiple choices are shown, reply with the letter only.
\end{quote}

\paragraph{Paraphrase set.}
\begin{quote}\small
[Q0] Which is larger? A) $2^{100}$ B) $10^{30}$ C) equal D) not enough information.  
[Q1] Which quantity has the greater magnitude, $2^{100}$ or $10^{30}$? Choose A, B, C, or D.  
[Q2] Compare $2^{100}$ and $10^{30}$. Which is bigger? A, B, C, or D.  
[Q3] Decide which value exceeds the other: $2^{100}$ vs $10^{30}$. Answer with A, B, C, or D.  
[Q4] Select the larger value from the options: A) $2^{100}$ B) $10^{30}$ C) equal D) insufficient data.  
[Q5] Among $2^{100}$ and $10^{30}$, which is numerically greater? Reply A, B, C, or D.  
[Q6] Choose the correct option that identifies the larger number: A) $2^{100}$ B) $10^{30}$ C) equal D) not enough information.
\end{quote}

\paragraph{Pathway templates.}
\begin{quote}\small
Template A: Answer with the final letter only.  
Template B: Think through the problem internally. Output only the final letter. Do not include steps.
\end{quote}

\paragraph{Ordering prompts.}
\begin{quote}\small
A then B: Context: [Alpha City Library moved its weekly closure from Monday to Tuesday in July. Notices were posted on June 28.] [The library used to close on Mondays to balance weekend staffing. Some older flyers still mention Monday.] Question: On which weekday is the library currently closed? Reply with a single weekday.

B then A: Context: [The library used to close on Mondays to balance weekend staffing. Some older flyers still mention Monday.] [Alpha City Library moved its weekly closure from Monday to Tuesday in July. Notices were posted on June 28.] Question: On which weekday is the library currently closed? Reply with a single weekday.
\end{quote}

\subsection{What this demo does not measure}
\label{app:limits}
This procedure does not estimate $\kappa_{\mathrm{inv}}$, commutators, or any internal transport. It uses agreement rates and ordering flips as observable stand-ins. The purpose is to give practitioners a taste of the WILSON workflow that fits public chat interfaces.

\subsection{Optional: full WILSON cross-model plan}
\label{app:full-crossmodel}
With internal hooks, one can correlate two models A and B as follows: (i) compute curvature maps for a shared probe set, (ii) apply a gauge-stable alignment by whitening and Procrustes on matched fibers, (iii) compare curvature clusters and predict high-risk items where both models have elevated curvature near the same layers and positions, (iv) validate with black-box drift on those items. We leave this to future work.
